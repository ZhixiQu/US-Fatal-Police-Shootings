---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - Zhixi(Arno) Qu
thanks: "Code and data are available at: [https://github.com/RohanAlexander/starter_folder](https://github.com/RohanAlexander/starter_folder)."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

#### Workspace setup ####
library(tidyverse)
library(palmerpenguins)
library(readxl)

#### Load data for graph ####
state_year_rates = read_csv(here::here("data/02-analysis_data/state_year_rates.csv"))
logistic_data = read_csv(here::here("data/02-analysis_data/logistic_data.csv"))
```


# Introduction

Overview paragraph

Estimand paragraph

Results paragraph

Why it matters paragraph

Telegraphing paragraph: The remainder of this paper is structured as follows. @sec-data....






# Data {#sec-data}

## Overview

We use the statistical programming language R [@citeR].... Our data [@shelter].... Following @tellingstories, we consider...

Overview text

## Measurement
	
Some paragraphs about how we go from a phenomena in the world to an entry in the dataset.

## Outcome variables

Add graphs, tables and text. Use sub-sub-headings for each outcome variable or update the subheading to be singular.



Some of our data is of penguins (@fig-bills), from @palmerpenguins.

```{r}
#| label: fig-bills
#| fig-cap: Bills of penguins
#| echo: false

ggplot(penguins, aes(x = island, fill = species)) +
  geom_bar(alpha = 0.8) +
  scale_fill_manual(values = c("darkorange","purple","cyan4"),
                    guide = "none") +
  theme_minimal() +
  facet_wrap(~species, ncol = 1) +
  coord_flip()
```

Talk more about it.

And also planes (@fig-planes). (You can change the height and width, but don't worry about doing that until you have finished every other aspect of the paper - Quarto will try to make it look nice and the defaults usually work well once you have enough text.)

```{r}
#| label: fig-planes
#| fig-cap: U.S. Fatal police shooting rate over time per million (rate)
#| echo: false
#| warning: false
#| message: false
#| 
us_year_rates = state_year_rates %>%
  group_by(year) %>%
  summarise(total_deaths_per_year = sum(deaths, na.rm = TRUE), 
            total_pop_per_year = sum(pop, na.rm = TRUE), 
            us_fatal_rate_per_million = 
              total_deaths_per_year/total_pop_per_year*1000000,
            .groups = "drop")
ggplot(us_year_rates, aes(x = year, y = us_fatal_rate_per_million)) +
  geom_line() +
  geom_point() +
  labs(x = "Year", y = "Rate") +
  theme_minimal()
```

```{r}
#| label: fig
#| fig-cap: Active Rate of Body Cameras in Fatal Police Shooting(US 2015–2024)
#| echo: false
#| warning: false
#| message: false
change_bodycamera = logistic_data %>%
  group_by(year) %>%
  summarise(num_death = n(), num_bodycam_on = sum(body_camera_binary == 1),
            activation_rate = (num_bodycam_on / num_death)*100, .groups = "drop")
ggplot(change_bodycamera, aes(x = year, y = activation_rate)) + geom_line() + 
  geom_point() +
  labs(x = "Year", y = "Rate(%)") +
  theme_minimal()
```

Talk way more about it. 

## Predictor variables

Add graphs, tables and text.

Use sub-sub-headings for each outcome variable and feel free to combine a few into one if they go together naturally.

```{r}
#| label: fige
#| fig-cap: Active Rate of Body Cameras in Fatal Police Shooting(US 2015–2024)
#| echo: false
#| warning: false
#| message: false

# 3a: race
ggplot(logistic_data, aes(x = race)) + geom_bar() +
  labs(x = "Race", y = "Count", title = "Distribution of victim race") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# 3b: gender
ggplot(logistic_data, aes(x = gender)) + geom_bar() +
  labs(x = "Gender", y = "Count", title = "Distribution of victim gender") +
  theme_minimal()

# 3c: age_group
ggplot(logistic_data, aes(x = age_group)) + geom_bar() +
  labs(x = "Age group", y = "Count", title = "Distribution of victim age groups") +
  theme_minimal()

# 3d: armed
ggplot(logistic_data, aes(x = armed)) + geom_bar() +
  labs(x = "Armed status", y = "Count", title = "Distribution of armed status") +
  theme_minimal()

# 3e: flee
ggplot(logistic_data, aes(x = flee)) + geom_bar() +
  labs(x = "Fleeing status", y = "Count", title = "Distribution of fleeing status"
       ) + theme_minimal()

# 3f: whether_mental_ill
ggplot(logistic_data, aes(x = whether_mental_ill)) +geom_bar() +
  labs(x = "Mental-illness related", y = "Count", 
       title = "Incidents flagged as related to mental illness") + 
  theme_minimal()
```







# Model

The goal of our modelling strategy is twofold. Firstly,...

Here we briefly describe the Bayesian analysis model used to investigate... Background details and diagnostics are included in [Appendix -@sec-model-details].

## Model set-up

Define $y_i$ as the number of seconds that the plane remained aloft. Then $\beta_i$ is the wing width and $\gamma_i$ is the wing length, both measured in millimeters.  

\begin{align*}
y_i \mid p_i &\sim \text{Bernoulli}(p_i) \nonumber
\end{align*}
\begin{align*}
\log\left(\frac{\hat{p}_i}{1 - \hat{p}_i}\right)
  &= \beta_0
   + \beta_1 \,\text{race}_i
   + \beta_2 \,\text{gender}_i
   + \beta_3 \,\text{age}_i
   + \beta_4 \,\text{armed}_i
   + \beta_5 \,\text{flee}_i \\[-2pt]
  &\quad
   + \beta_6 \,\text{mental\_health}_i
   + \beta_7 \,\text{year}_i
   + \beta_8 \,\text{race}_i \times \text{armed}_i
\end{align*}

\begin{align*}
\beta_0 &\sim \text{Normal}(0, 2.5) \\
\beta_1 &\sim \text{Normal}(0, 2.5) \\
\beta_2 &\sim \text{Normal}(0, 2.5) \\
\beta_3 &\sim \text{Normal}(0, 2.5) \\
\beta_4 &\sim \text{Normal}(0, 2.5) \\
\beta_5 &\sim \text{Normal}(0, 2.5) \\
\beta_6 &\sim \text{Normal}(0, 2.5) \\
\beta_7 &\sim \text{Normal}(0, 2.5) \\
\beta_8 &\sim \text{Normal}(0, 2.5)
\end{align*}

where,
- $\hat{p}$ represents the probability that the body camera were activated.
- $\beta_0$ represents the intercept term of this logistical regression. It is the probability that body cameras being activated when an individual belongs to the reference group for each categorical variable and the year is 2015.
- $\beta_1$ is the coefficient corresponding to race of the victim.
- $\beta_2$ is the coefficient corresponding to gender of the victim.
- $\beta_3$ is the coefficients corresponding to age group of the person, Age group is categorical variable grouped by the victim's age. The categories are: Under 18, "18–29"、"30–44"、"45–59"、"60+".
- $\beta_4$ is the coefficients corresponding to whether the victim is armed.
- $\beta_5$ is the coefficients corresponding to whether the victim is fleeing.
- $\beta_6$ is the coefficients corresponding to whether the victim had a history of mental health issues.
- $\beta_7$ is the coefficients corresponding to the year the event occurred.
- $\beta_8$ is the coefficients corresponding to the interaction term between the race of victim and whether the victim were armed.

We run the model in R [@citeR] using the `rstanarm` package of @rstanarm. We use the default priors from `rstanarm`.


### Model justification

We expect a positive relationship between the size of the wings and time spent aloft. In particular...

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results

Our results are summarized in @tbl-modelresults.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false

library(rstanarm)

first_model <-
  readRDS(file = here::here("models/first_model.rds"))
```






# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

Please don't use these as sub-heading labels - change them to be what your point actually is.

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details


\newpage


# References


